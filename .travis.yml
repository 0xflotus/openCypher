language: java
jdk:
  - oraclejdk8
# we want the latest release of JDK8
addons:
  apt:
    packages:
      - oracle-java8-installer
install: 'if [ "${TRAVIS_SECURE_ENV_VARS}" = "true" ] ; then mvn --settings .build/deploy-settings.xml -DaltDeploymentRepository=snapshots::default::http://m2.neo4j.org/content/repositories/snapshots clean deploy ; else mvn clean verify ; fi'
script:
  - java -jar tools/grammar/target/grammar-1.0-SNAPSHOT.jar ISO14977 cypher.xml > grammar/generated/cypher.ebnf
  - java -jar tools/grammar/target/grammar-1.0-SNAPSHOT.jar Antlr4 cypher.xml > grammar/generated/Cypher.g4
  - java -DRailRoadDiagrams.outputDir=grammar/generated/railroad -jar tools/grammar/target/grammar-1.0-SNAPSHOT.jar RailRoadDiagrams cypher.xml
deploy:
  provider: s3
  bucket: artifacts.opencypher.org
  skip_cleanup: true
  file:
    - "grammar/generated/cypher.ebnf"
    - "grammar/generated/Cypher.g4"
    - "grammar/generated/railroad/*.svg"
  access_key_id:
    secure: ZDs584oHbxu7ODTk00Dm9TTn5cfh9TUr/4ktF0BOFYECpu8jCZz6FYc0FdQvYfvL/wGL22lQO5F4kvacFLEisEBcDhFbWCW79mH61KYuk5lPOZjcrYpheELWyo4L1VT4SIqAE2W3mqyNf3thxqXxNqwjSIvQffX25h8ZslW0HzNCCF0BuF5Elhv3QoOpQrwbHeMlwP6THlhQTxsPSvovHK2l8lL7oICm3egLyDTw0goSjgMxME6oGPBwjcTbrHkWbirbhCBMEo8UClA3/klWntVO7RIbzcmVJA7ydYtxRQ1PJ7P/PeqkLGcgD5tnMaFEe0NMBr1rVl1gDVdWmAarXpBm/Gm/acUPrLWcJRqgSPpXVLY2GQ2GzAJpPNlvnJ2qaCQBPwyq7c/lN+g6rLI/OxNBQ6mH/FSjFTRvQOI6Lpbvf//yThsw1bSAUTSy993BndOgbdg0X4hKg6TKG+M7OUSnMgPwxwFoopDbody8AglyTpZJBSXTnb2HL0+RgNtSn/7zVrLj1LmIGylC+ncmrRc4QpRDdh0Tu8dOCvQL4wA6xDkFPmgj338XTsAPKCw8eNgItnzmFJxCxUlwwdA67P28/oAP+W5rxAHnGyDdvtdah5DoO+chd5bnkJY9r1W7a9655mBPhixP1+nPESq0RBm8cj47kh0NKgGBD5fW6CQ=
  secret_access_key:
    secure: CfcQ0Lulro67Ue15RYfczqcf8WDyqaCC35HhBoZNtVP706A63rSJd/QQknUzjpVNUOtTjEViB3nyDSjR1tX352XaDFPAmfE1M622wmpac4qbKuDpRucJiehP9MAjiaAdz/VFYZZFLwFMR3PpNjyX+8tV7oUZ4wTjo+GPyfP1M8oXbTqUZnqbyD9XfatZZZcFqA2cW+BWh49iqxlGMJpatC6Ac+xabFeJ9xVaqFE8cAOb48Dtd5ksKS9oUKZ6W1sJa0DSsqE2gqsaCsynj+P4dbwqpDm2VPrF7R6IuO3SBp1STuFVj0XTNN3alfgCFE89Dac9vlacyiggfJsUEA2NolOp4n98BYVVNGXDXF9eoIhcq9F2h0RmSrmyjPBy/K1pxRvYGqAbzuH7sb3IMsjFPIn66kyyGxx0krxEl3vJBsYaMHJFfxuSPbZLIAz7hhhy3EXA/YLgSnAKkph/SMmMDuawobbGcSpHol84wDRKWg3OV3ekcbCmDCWxI1RNftZIX8htvyGI6ibc/Y5+La2j2KWpm6Jrn5vmKxqB9giTI3k4LYpLyg7jY7CWzj3htVtzLi+eETsQITjSNksncpy5DLxfwBHPw3NJ0P3egJeXexQypxiZYUEtstvFTYlu7vntRgji/qOIrq4eFoGEoVxwisoWpWvKbHgb/tkFxYeXzNc=
